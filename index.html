<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>GitHub User Creation Date</title>
  <!-- Bootstrap (latest stable) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@latest/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body {
      padding-top: 40px;
    }
    #github-created-at {
      min-height: 1.25em;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="mb-4">GitHub User Creation Date</h1>

    <form id="github-user-100" class="row g-3 align-items-center">
      <div class="col-auto">
        <label class="form-label visually-hidden" for="github-username">GitHub username</label>
        <input type="text" id="github-username" class="form-control" placeholder="GitHub username" required />
      </div>
      <div class="col-auto">
        <button type="submit" class="btn btn-primary">Fetch</button>
      </div>
      <div class="col-12" aria-live="polite" id="status" style="min-height:1.25em;"></div>
      <div class="col-12 small text-muted">
        Optional: append ?token=YOUR_TOKEN to the page URL to authenticate requests.
      </div>
    </form>

    <hr/>

    <div class="row gy-3">
      <div class="col-12">
        <strong>Creation date (UTC):</strong>
        <span id="github-created-at" class="ms-2" style="min-width:200px; display:inline-block;">-</span>
      </div>
      <div class="col-12">
        <strong>Account age:</strong>
        <span id="github-account-age" class="ms-2" style="min-width:180px; display:inline-block;">-</span>
      </div>
    </div>
  </div>

  <script>
    (function(){
      document.addEventListener('DOMContentLoaded', function() {
        const url = new URL(window.location.href);
        const token = url.searchParams.get('token');

        const form = document.getElementById('github-user-100');
        const usernameInput = document.getElementById('github-username');
        const createdAtEl = document.getElementById('github-created-at');
        const ageEl = document.getElementById('github-account-age');
        const statusEl = document.getElementById('status');

        function setStatus(msg) {
          statusEl.textContent = msg;
        }

        form.addEventListener('submit', async function(e) {
          e.preventDefault();
          const username = (usernameInput.value || '').trim();
          if (!username) {
            setStatus('Please enter a GitHub username.');
            return;
          }

          // Reset display
          setStatus('Fetching...');
          createdAtEl.textContent = '-';
          ageEl.textContent = '-';

          try {
            const headers = {
              'Accept': 'application/vnd.github.v3+json'
            };
            if (token) {
              headers['Authorization'] = 'token ' + token;
            }

            const resp = await fetch('https://api.github.com/users/' + encodeURIComponent(username), {
              headers: headers
            });

            if (!resp.ok) {
              if (resp.status === 404) {
                setStatus('User not found.');
              } else if (resp.status === 401) {
                setStatus('Unauthorized. Check your token.');
              } else {
                setStatus('Error fetching user data: ' + resp.status);
              }
              createdAtEl.textContent = '-';
              ageEl.textContent = '-';
              return;
            }

            const data = await resp.json();
            const createdAtStr = data.created_at;
            if (!createdAtStr) {
              setStatus('Creation date not available.');
              createdAtEl.textContent = '-';
              ageEl.textContent = '-';
              return;
            }

            const createdDate = new Date(createdAtStr);
            const yyyy = createdDate.getUTCFullYear().toString().padStart(4, '0');
            const mm = String(createdDate.getUTCMonth() + 1).padStart(2, '0');
            const dd = String(createdDate.getUTCDate()).padStart(2, '0');
            const dateStr = `${yyyy}-${mm}-${dd} UTC`;
            createdAtEl.textContent = dateStr;

            // Compute age in whole years (UTC)
            const now = new Date();
            let years = now.getUTCFullYear() - createdDate.getUTCFullYear();
            const nowMonth = now.getUTCMonth();
            const createdMonth = createdDate.getUTCMonth();
            if (nowMonth < createdMonth || (nowMonth === createdMonth && now.getUTCDate() < createdDate.getUTCDate())) {
              years--;
            }

            const yearLabel = (years === 1) ? 'year' : 'years';
            ageEl.textContent = `Account age: ${years} ${yearLabel}`;

            setStatus('Success');
          } catch (err) {
            setStatus('Network error or invalid response.');
            createdAtEl.textContent = '-';
            ageEl.textContent = '-';
          }
        });
      });
    })();
  </script>

  <!-- Bootstrap JS (optional, for completeness) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@latest/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>